<!--pages/user-profile/user-profile.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨é’±åŒ…èƒŒæ™¯åŒºåŸŸ -->
  <view class="wallet-header-section">
    <!-- èƒŒæ™¯å›¾ç‰‡å’Œé®ç½© -->
    <view class="wallet-background" style="{{walletBackgroundStyle}}">
      <view class="background-overlay"></view>
      
      <!-- é¡¶éƒ¨å¯¼èˆª -->
      <view class="header-nav">
        <view class="nav-left" bindtap="goBack">
          <view class="back-icon">â€¹</view>
        </view>
        <view class="nav-right">
          <!-- ç©ºç™½åŒºåŸŸ -->
        </view>
      </view>
      
      <!-- ç”¨æˆ·ä¿¡æ¯ -->
      <view class="user-info" catchtap="stopPropagation">
        <view class="user-avatar">
          <text class="avatar-text">{{wallet.name ? wallet.name.charAt(0) : 'U'}}</text>
        </view>
        <view class="user-details">
          <text class="user-title">{{wallet.name || '07å¹´å°å¥³ç”Ÿæ”’é’±'}}ğŸ’—</text>
          <view class="user-tags-row">
            <text class="user-tags">#æˆé•¿ #ç”Ÿæ´»</text>
            <text class="user-desc">{{userInfo.description || '07å¹´å°å¥³ç”Ÿä»2025.2.1å¼€å§‹å­˜é’± ç›®æ ‡â€¦'}}</text>
          </view>
          <view class="user-badges">
            <view class="badge">è‡ªå·±ç”¨</view>
            <view class="badge">å…¬å¼€</view>
          </view>
        </view>
        <view class="expand-icon">å±•å¼€</view>
      </view>
      
      <!-- ç»Ÿè®¡ä¿¡æ¯å’Œå…³æ³¨æŒ‰é’® -->
      <view class="stats-and-follow" catchtap="stopPropagation">
        <view class="stats-row">
          <view class="stat-item">
            <text class="stat-number">{{socialStats.fansCount}}</text>
            <text class="stat-label">ç²‰ä¸</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{socialStats.likesCount}}</text>
            <text class="stat-label">è·èµ</text>
          </view>
          <view class="stat-item">
            <text class="stat-number">{{socialStats.viewsCount}}</text>
            <text class="stat-label">æµè§ˆ</text>
          </view>
        </view>
        
        <view class="follow-buttons">
          <image class="follow-btn-image {{isFollowing ? 'followed' : ''}}" 
                 src="{{isFollowing ? '/images/res/ä¸ªäººä¸»è¯¦æƒ…/png/å·²å…³æ³¨.png' : '/images/res/ä¸ªäººä¸»è¯¦æƒ…/png/å…³æ³¨.png'}}" 
                 bindtap="toggleFollow"
                 mode="aspectFit" />
        </view>
      </view>
    </view>
  </view>

  <!-- æ€»é‡‘é¢å¡ç‰‡ -->
  <view class="balance-card">
    <text class="balance-label">æ€»é‡‘é¢ï¼ˆå…ƒï¼‰</text>
    <text class="balance-amount">{{wallet.balance || '31123.12'}}</text>
  </view>

  <!-- æ ‡ç­¾æ  -->
  <view class="tab-bar">
    <view class="tab-item {{activeTab === 'bill' ? 'active' : ''}}" 
          bindtap="switchTab" 
          data-tab="bill">
      <text class="tab-text">è´¦å•</text>
      <view wx:if="{{activeTab === 'bill'}}" class="tab-indicator"></view>
    </view>
  </view>

  <!-- è´¦å•åˆ—è¡¨ -->
  <view wx:if="{{activeTab === 'bill'}}" class="transactions-list">
    <view wx:if="{{transactions.length === 0}}" class="empty-transactions">
      <text class="empty-text">æš‚æ— è´¦å•è®°å½•</text>
    </view>

    <view wx:for="{{transactions}}" wx:key="id" class="transaction-item">
      <!-- ç”¨æˆ·å¤´åƒ -->
      <view class="transaction-avatar">
        <text class="avatar-text">{{item.description ? item.description.charAt(0) : 'U'}}</text>
      </view>
      
      <!-- äº¤æ˜“ä¿¡æ¯ -->
      <view class="transaction-info">
        <view class="transaction-header">
          <text class="transaction-title">{{item.description}}</text>
          <text class="transaction-amount">{{item.amount}}</text>
        </view>
        <text class="transaction-category">{{item.category}}</text>
        <text class="transaction-date">{{item.date}}</text>
        
        <!-- äº’åŠ¨åŒºåŸŸ -->
        <view class="transaction-interactions">
          <!-- ç”¨æˆ·è¯„è®º -->
          <view wx:if="{{item.userComment}}" class="user-comment">
            <view class="comment-avatar">
              <text class="avatar-text">{{item.userComment.username ? item.userComment.username.charAt(0) : 'U'}}</text>
            </view>
            <view class="comment-content">
              <text class="comment-username">{{item.userComment.username}}ï¼š</text>
              <text class="comment-text">{{item.userComment.message}}</text>
            </view>
          </view>
          
          <!-- ç‚¹èµå’Œè¯„è®º -->
          <view class="interaction-row">
            <view class="interaction-item" bindtap="likeTransaction" 
                  data-id="{{item.id}}" data-index="{{index}}">
              <view class="like-icon"></view>
              <text class="interaction-count">{{item.likes || 0}}</text>
            </view>
            
            <view class="interaction-item" bindtap="commentTransaction" data-id="{{item.id}}">
              <view class="comment-icon"></view>
              <text class="interaction-count">{{item.comments || 0}}</text>
            </view>
          </view>
        </view>
      </view>
    </view>
    
    <!-- åˆ†éš”çº¿ -->
    <view wx:if="{{index < transactions.length - 1}}" class="transaction-divider"></view>
  </view>

  <!-- åº•éƒ¨å®‰å…¨åŒºåŸŸ -->
  <view class="safe-area-bottom"></view>
</view>
