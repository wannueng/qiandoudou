<!--pages/wallet-messages/wallet-messages.wxml-->
<view class="container">
  <!-- é¡¶éƒ¨å¯¼èˆªæ  -->
  <view class="top-nav">
    <view class="nav-left" bindtap="goBack">
      <view class="back-icon"></view>
    </view>
    <view class="nav-title">é’±å…œå…œäº’åŠ¨æ¶ˆæ¯</view>
    <view class="nav-right"></view>
  </view>

  <!-- æ¶ˆæ¯åˆ—è¡¨ -->
  <view class="messages-list">
    <!-- åŠ è½½çŠ¶æ€ -->
    <view wx:if="{{loading}}" class="loading-container">
      <view class="loading-spinner"></view>
      <text class="loading-text">åŠ è½½ä¸­...</text>
    </view>

    <!-- æ¶ˆæ¯é¡¹ -->
    <view wx:for="{{messages}}" wx:key="id" class="message-item" bindtap="onMessageTap" data-message="{{item}}">
      <!-- å·¦ä¾§ç”¨æˆ·å¤´åƒ -->
      <view class="user-avatar-container">
        <view class="user-avatar">
          <image wx:if="{{item.user.avatar}}" 
                 class="avatar-image" 
                 src="{{item.user.avatar}}" 
                 mode="aspectFill"/>
          <text wx:else class="avatar-text">{{item.user.nickname ? item.user.nickname.charAt(0) : 'ç”¨'}}</text>
        </view>
      </view>

      <!-- ä¸­é—´å†…å®¹åŒºåŸŸ -->
      <view class="message-content">
        <!-- ç¬¬ä¸€è¡Œï¼šç”¨æˆ·åç§° -->
        <view class="user-name">{{item.user.nickname || 'ç”¨æˆ·'}}</view>
        
        <!-- ç¬¬äºŒè¡Œï¼šäº’åŠ¨å†…å®¹ -->
        <view class="interaction-content">
          <text wx:if="{{item.type === 'follow'}}">å…³æ³¨äº†ä½ </text>
          <text wx:elif="{{item.type === 'like'}}">ç»™ä½ ç‚¹èµ</text>
          <text wx:elif="{{item.type === 'comment'}}">{{item.content}}</text>
        </view>
        
        <!-- ç¬¬ä¸‰è¡Œï¼šæ¥æºå’Œæ—¶é—´ -->
        <view class="message-meta">
          <text class="source">æ”¯ä»˜å®é’±å…œå…œ</text>
          <text class="time">{{item.timeText}}</text>
        </view>
      </view>

      <!-- å³ä¾§åŠ¨æ€å›¾ç‰‡ -->
      <view class="post-image-container">
        <image wx:if="{{item.postImage}}" 
               class="post-image" 
               src="{{item.postImage}}" 
               mode="aspectFill"/>
      </view>
    </view>

    <!-- ç©ºçŠ¶æ€ -->
    <view wx:if="{{!loading && messages.length === 0}}" class="empty-state">
      <view class="empty-icon">ğŸ“­</view>
      <text class="empty-text">æš‚æ— äº’åŠ¨æ¶ˆæ¯</text>
      <text class="empty-desc">å½“æœ‰ç”¨æˆ·å…³æ³¨ã€ç‚¹èµæˆ–è¯„è®ºä½ çš„é’±å…œå…œæ—¶ï¼Œæ¶ˆæ¯ä¼šæ˜¾ç¤ºåœ¨è¿™é‡Œ</text>
    </view>
  </view>
</view>
